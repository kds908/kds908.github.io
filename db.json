{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"source/imgs/861644831979.jpg","path":"imgs/861644831979.jpg","modified":1,"renderable":0},{"_id":"source/imgs/diaoyu1.jpeg","path":"imgs/diaoyu1.jpeg","modified":1,"renderable":0},{"_id":"source/imgs/gongneng.jpg","path":"imgs/gongneng.jpg","modified":1,"renderable":0},{"_id":"source/imgs/taejune-kim-blue-1600.jpg","path":"imgs/taejune-kim-blue-1600.jpg","modified":1,"renderable":0},{"_id":"themes/butterfly/source/css/var.styl","path":"css/var.styl","modified":1,"renderable":1},{"_id":"themes/butterfly/source/css/index.styl","path":"css/index.styl","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/1.jpg","path":"imgs/1.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/3.jpg","path":"imgs/3.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/2.jpg","path":"imgs/2.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/4.jpg","path":"imgs/4.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/5.jpg","path":"imgs/5.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/6.jpg","path":"imgs/6.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/7.jpg","path":"imgs/7.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/8.jpg","path":"imgs/8.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/imgs/9.jpg","path":"imgs/9.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/js/main.js","path":"js/main.js","modified":1,"renderable":1},{"_id":"themes/butterfly/source/js/tw_cn.js","path":"js/tw_cn.js","modified":1,"renderable":1},{"_id":"themes/butterfly/source/js/utils.js","path":"js/utils.js","modified":1,"renderable":1},{"_id":"themes/butterfly/source/img/404.jpg","path":"img/404.jpg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/img/algolia.svg","path":"img/algolia.svg","modified":1,"renderable":1},{"_id":"themes/butterfly/source/img/favicon.png","path":"img/favicon.png","modified":1,"renderable":1},{"_id":"themes/butterfly/source/img/friend_404.gif","path":"img/friend_404.gif","modified":1,"renderable":1},{"_id":"themes/butterfly/source/js/search/algolia.js","path":"js/search/algolia.js","modified":1,"renderable":1},{"_id":"themes/butterfly/source/js/search/local-search.js","path":"js/search/local-search.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"d49864dae3fc3ffe36a6c41535ef6a9924f199f5","modified":1644919505267},{"_id":"source/_data/link.yml","hash":"a7cf76bc87b802681dbe05842cd2d9828e6106bd","modified":1644919505267},{"_id":"source/categories/index.md","hash":"748df9c9e572e59f9e2d127cb61cb9eafce46eb1","modified":1644919505268},{"_id":"source/_posts/.DS_Store","hash":"182460f4c737d372e05d732628641266fda181ee","modified":1644919505267},{"_id":"source/imgs/.DS_Store","hash":"e29bf23f19351349406d95fed5400f9e6bd8da9f","modified":1644919505268},{"_id":"source/_posts/开源项目 mall 商城学习（一）.md","hash":"f264cf05ee6b038c6ae55d2378d993a9aa5ae9c1","modified":1644919505268},{"_id":"source/link/index.md","hash":"f3f9bf64ebc4f248f9f42a0f59f93f15c886f214","modified":1644919505275},{"_id":"source/about/index.md","hash":"291bc2cab5a1df1c5a9c119aab85a24569939153","modified":1644919505268},{"_id":"source/tags/index.md","hash":"2dda1908d360549277ac5817adc1302192a19b14","modified":1644919505275},{"_id":"source/imgs/861644831979.jpg","hash":"232e60e28993e8fca2e800198fd36b4873ede298","modified":1644919505269},{"_id":"source/imgs/taejune-kim-blue-1600.jpg","hash":"8bc32da712cb2aa241196f8d68f7b565f40feac5","modified":1644919505274},{"_id":"source/imgs/diaoyu1.jpeg","hash":"ccfa2ef2d75c6c3bbcf8966b616d0e7b7668d407","modified":1644919505269},{"_id":"themes/butterfly/README.md","hash":"cedd13fcd8c75a68742265dd8eced4087e940ffd","modified":1638778544000},{"_id":"themes/butterfly/LICENSE","hash":"1128f8f91104ba9ef98d37eea6523a888dcfa5de","modified":1638778544000},{"_id":"themes/butterfly/package.json","hash":"333603963b3d2cedb643def8a9955f6d540f5d95","modified":1638778544000},{"_id":"themes/butterfly/README_CN.md","hash":"459d6f3200863021bee1fe72a719aef236fb4090","modified":1638778544000},{"_id":"themes/butterfly/.github/stale.yml","hash":"05a55a87fa7f122c59683e41c8b2e37e79f688f0","modified":1638778544000},{"_id":"themes/butterfly/_config.yml","hash":"117f0e46e05789b7532af7ad4c10d8d29a82a6f4","modified":1644917832650},{"_id":"themes/butterfly/languages/default.yml","hash":"7ca673fb629ea74f5ba5e75b4f0f95248cfb5090","modified":1638778544000},{"_id":"themes/butterfly/languages/en.yml","hash":"cd333235ff1648a6bf58dfafc81f2c57672a15a5","modified":1638778544000},{"_id":"themes/butterfly/languages/zh-CN.yml","hash":"741e522b2387f94764a73844e7b084cc7e927c54","modified":1638778544000},{"_id":"themes/butterfly/languages/zh-TW.yml","hash":"79a50c40d9f5463f1fa42aa870ac6b8b84540412","modified":1638778544000},{"_id":"themes/butterfly/layout/archive.pug","hash":"bd62286afb64a51c97e800c5945620d51605d5fa","modified":1638778544000},{"_id":"themes/butterfly/layout/category.pug","hash":"60c1b795b6e227b5dd81963b51d29d1b81d0bf49","modified":1638778544000},{"_id":"themes/butterfly/layout/page.pug","hash":"82aa988527a11835e7ac86ce4f23b8cd20014dfa","modified":1638778544000},{"_id":"themes/butterfly/layout/index.pug","hash":"e1c3146834c16e6077406180858add0a8183875a","modified":1638778544000},{"_id":"themes/butterfly/layout/post.pug","hash":"8d398c8925182699d9f2b9f1b727f06228488312","modified":1638778544000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/custom.md","hash":"eff495eb1584cf4586e33c76e8b2fa6a469a179b","modified":1638778544000},{"_id":"themes/butterfly/layout/tag.pug","hash":"0440f42569df2676273c026a92384fa7729bc4e9","modified":1638778544000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/bug_report.md","hash":"476802922b774b679225102ac30a9d9183394701","modified":1638778544000},{"_id":"themes/butterfly/.github/workflows/publish.yml","hash":"05857c2f265246d8de00e31037f2720709540c09","modified":1638778544000},{"_id":"themes/butterfly/.github/ISSUE_TEMPLATE/feature_request.md","hash":"f6867a2f0417fe89a0f2008730ee19dd38422021","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/additional-js.pug","hash":"4156224c47bfc2482281ac4e4df701c30476ff00","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/footer.pug","hash":"02390a5b6ae1f57497b22ba2e6be9f13cfb7acac","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/pagination.pug","hash":"0b80f04950bd0fe5e6c4e7b7559adf4d0ce28436","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head.pug","hash":"1377952022ee0a9eaa7a2fd1098f1571efc468d9","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/layout.pug","hash":"6f2608c4d93d3d10ae6b2cd7f8918f303f024321","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/404.pug","hash":"7d378e328a53cc99d5acc9682dce53f5eb61537d","modified":1638778544000},{"_id":"themes/butterfly/scripts/helpers/inject_head_js.js","hash":"65f2442e04c4defd16e7c1e67701d3bb41d9577a","modified":1638778544000},{"_id":"themes/butterfly/scripts/helpers/aside_categories.js","hash":"e00efdb5d02bc5c6eb4159e498af69fa61a7dbb9","modified":1638778544000},{"_id":"themes/butterfly/scripts/helpers/related_post.js","hash":"21556f9cb412ddc500ad12ecfd419f3ea6c9f663","modified":1638778544000},{"_id":"themes/butterfly/scripts/helpers/aside_archives.js","hash":"2ec66513d5322f185d2071acc052978ba9415a8e","modified":1638778544000},{"_id":"themes/butterfly/scripts/events/404.js","hash":"83cd7f73225ccad123afbd526ce1834eb1eb6a6d","modified":1638778544000},{"_id":"themes/butterfly/scripts/helpers/page.js","hash":"c6611d97087c51845cb1ab4821696a62fa33daeb","modified":1638778544000},{"_id":"themes/butterfly/scripts/events/init.js","hash":"018aa446265fe627301b1d53d7cba4f4ff1960ac","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/button.js","hash":"b816ded1451f28c7c54151ffe6c259b110253ae3","modified":1638778544000},{"_id":"themes/butterfly/scripts/events/welcome.js","hash":"d575137c8779e50422c2416f4d0832fdea346ee6","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/hide.js","hash":"f33858ffb9e88191e644796e11d2f901eb332308","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/inlineImg.js","hash":"a43ee2c7871bdd93cb6beb804429e404570f7929","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/gallery.js","hash":"94826ea6bcc4d2304199adae12c4e2b272caf529","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/mermaid.js","hash":"35f073021db93699fcac9ef351e26c59c31aadf7","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/label.js","hash":"03b2afef41d02bd1045c89578a02402c28356006","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/note.js","hash":"c16c6eb058af2b36bcd583b2591076c7ebdd51ad","modified":1638778544000},{"_id":"themes/butterfly/scripts/tag/tabs.js","hash":"6c6e415623d0fd39da016d9e353bb4f5cca444f5","modified":1638778544000},{"_id":"themes/butterfly/scripts/filters/post_lazyload.js","hash":"4cc2d517195c8779471d326ada09f9371cbad4dd","modified":1638778544000},{"_id":"themes/butterfly/scripts/filters/random_cover.js","hash":"9821872007cf57efae4b728dc575ef9d004547bb","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/rightside.pug","hash":"2d0453adf92a3fd3466cf0793f14685d17b8b51d","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/sidebar.pug","hash":"8dafc2dcd8c33f70a546fee443f0b6d80b3cd243","modified":1638778544000},{"_id":"themes/butterfly/source/css/var.styl","hash":"40c3f64422205a24e68ce1ad8fe8163f24fdd525","modified":1638778544000},{"_id":"themes/butterfly/source/imgs/.DS_Store","hash":"adbea7961dbd857ebcf78dd37f29ffa5ef16e943","modified":1638842515000},{"_id":"themes/butterfly/source/css/index.styl","hash":"861998e4ac67a59529a8245a9130d68f826c9c12","modified":1638778544000},{"_id":"themes/butterfly/source/imgs/3.jpg","hash":"663154c0e3f2ceb55222181ee1afbc198e61214f","modified":1638842515000},{"_id":"themes/butterfly/source/js/main.js","hash":"b244f28124a46d7f1e8ef76ba6e925289691f93b","modified":1638778544000},{"_id":"themes/butterfly/source/js/tw_cn.js","hash":"00053ce73210274b3679f42607edef1206eebc68","modified":1638778544000},{"_id":"themes/butterfly/source/js/utils.js","hash":"8319b59c26ce8cd2b0ae7d030c4912215148fa92","modified":1638778544000},{"_id":"themes/butterfly/source/img/algolia.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1638778544000},{"_id":"themes/butterfly/source/img/404.jpg","hash":"fb4489bc1d30c93d28f7332158c1c6c1416148de","modified":1638778544000},{"_id":"themes/butterfly/source/img/favicon.png","hash":"3cf89864b4f6c9b532522a4d260a2e887971c92d","modified":1638778544000},{"_id":"themes/butterfly/source/img/friend_404.gif","hash":"8d2d0ebef70a8eb07329f57e645889b0e420fa48","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/analytics.pug","hash":"90d01b88d0f406d00184960b1afe9230aec2ebe6","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/Open_Graph.pug","hash":"6c41f49a3e682067533dd9384e6e4511fc3a1349","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/noscript.pug","hash":"d16ad2ee0ff5751fd7f8a5ce1b83935518674977","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/google_adsense.pug","hash":"95a37e92b39c44bcbea4be7e29ddb3921c5b8220","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/config_site.pug","hash":"889ef16fa34a39e5533bc170e62f20f3450cc522","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/pwa.pug","hash":"3d492cfe645d37c94d30512e0b230b0a09913148","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/preconnect.pug","hash":"e55f8bdb876d5429a908498db1307b94094c0d06","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/site_verification.pug","hash":"e2e8d681f183f00ce5ee239c42d2e36b3744daad","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/head/config.pug","hash":"4def0aab9e2172ad1f29abd1535d8e08ff23aa0b","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/header/nav.pug","hash":"c205b9fd72b2fe19e6d15c5b5ab0fb38c653032e","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/header/social.pug","hash":"0d953e51d04a9294a64153c89c20f491a9ec42d4","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/header/menu_item.pug","hash":"24370508ee87f14418e8f06e9d79ad8c52a342c4","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/header/index.pug","hash":"65fa23680af0daf64930a399c2f2ca37809a8149","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/header/post-info.pug","hash":"92f81a437c9db49f7ebcf608bc09488ecdb55a21","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/mixins/post-ui.pug","hash":"4c3c5cb69b3aead8c232cb0fbc251929f28aad75","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/mixins/article-sort.pug","hash":"2fb74d0b0e4b98749427c5a1a1b0acb6c85fadc4","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/loading/loading.pug","hash":"5276937fbcceb9d62879dc47be880cd469a27349","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/loading/loading-js.pug","hash":"4cfcf0100e37ce91864703cd44f1cb99cb5493ea","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/page/default-page.pug","hash":"dbec869c62135695495703a29ad7655e9965d461","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/page/categories.pug","hash":"1f30952fed73dec21b42e2e30b7fe2e84618d2e4","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/page/flink.pug","hash":"b53a2d4f9c37b375a4446d2273dcfb7712d91b3e","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/page/tags.pug","hash":"93d4ebc7dc8228c7a10ddeb5a553d0dcdabbe145","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/post/post-copyright.pug","hash":"88e3b611b03149665e4113cfa39595c1a3fca7e5","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/post/reward.pug","hash":"5b404356f311d2ee36478291ca3553210867b738","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/aplayer.pug","hash":"292646dfab135973b09f0fa9e3931e83da2ed30e","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/effect.pug","hash":"b9d54a01d7c2a7a183cb7209e99430ce7fea1fe3","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/pangu.pug","hash":"d5fec7dedc52ab23865fb4db002755e9bdaadc9f","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/pjax.pug","hash":"933cb710d2dbcea25c6426a57c6f49d2f48b792c","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/prismjs.pug","hash":"1fbecfd299068f90d727f0c8c65e2a792fa6e3e2","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/subtitle.pug","hash":"d50e5c22cd6bc3c378bc581918136746cfa3447f","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_ad.pug","hash":"60dc48a7b5d89c2a49123c3fc5893ab9c57dd225","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_announcement.pug","hash":"3d8e3706a056389176f55dd21956aabc78046761","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_author.pug","hash":"0366c658cdcff839aa1df2e2d252a03a53fd427e","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_archives.pug","hash":"86897010fe71503e239887fd8f6a4f5851737be9","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_categories.pug","hash":"d1a416d0a8a7916d0b1a41d73adc66f8c811e493","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_bottom_self.pug","hash":"13dc8ce922e2e2332fe6ad5856ebb5dbf9ea4444","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_newest_comment.pug","hash":"27afd2274bd5f2cbbf1bad9f0afe2b2b72c213ca","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_post_toc.pug","hash":"ae9336bf31cdad08ff586ead4295912a96563c76","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_recent_post.pug","hash":"9c1229af6ab48961021886882c473514101fba21","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_top_self.pug","hash":"ae67c6d4130a6c075058a9c1faea1648bcc6f83e","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_webinfo.pug","hash":"0612aaee878f33ea8d3da0293c7dc3b6cd871466","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/card_tags.pug","hash":"438aea3e713ed16b7559b9a80a9c5ec0221263df","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/widget/index.pug","hash":"b5525891f6affd02c1ea3b2327c026882efe428b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_global/function.styl","hash":"eda47f3e807a466ba8275627ea936c5100c43818","modified":1638778544000},{"_id":"themes/butterfly/source/css/_global/index.styl","hash":"e211efbd1952d4b1b881287aa43423133c1d166e","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/aside.styl","hash":"7feb755ca7c22da36bbad11e74ecd95fdcf3b879","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/comments.styl","hash":"f1b63892baafa48ab872bc79671d57aafd511f6c","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/footer.styl","hash":"dd8cdf639ba2b726437c77fa7aa8d5edbabe8f9b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/head.styl","hash":"98235fcda3b87ad6f7e91eafbed94d0d6ae847ca","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/chat.styl","hash":"29f48f9370f245e6e575b5836bccf47eb5688d8b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/loading.styl","hash":"7d18a7be9cfea65091de3ef00014063d2d649912","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/pagination.styl","hash":"90fe01c968696a9f791cb2b84fca621cbbb56f47","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/theme.styl","hash":"fa4b87e7b29bdd1f09eb1a30e06ba74b224f0ba2","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/post.styl","hash":"d748951d9fbcd04dda839085af78b01b8fa04cba","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/relatedposts.styl","hash":"0551c5893d1589a3d17ce161e50ecb1d724cc6e8","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/rightside.styl","hash":"7a072589e6097dbe942783131964f2372fdf1eb6","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/reward.styl","hash":"ea1ba40dd5954c2ed718a126336fb7f94da4e66f","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/sidebar.styl","hash":"2c5fb77c448ce0a734040c8ce532b28fed688899","modified":1638778544000},{"_id":"themes/butterfly/source/css/_layout/third-party.styl","hash":"978c397d0966eaf9e6e2afd13866f8f4900b509f","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/highlight.styl","hash":"85e72c70a0cef29e40be1968f5d23b06c6f8e3aa","modified":1638778544000},{"_id":"themes/butterfly/source/css/_mode/darkmode.styl","hash":"4e629f510b73f998ab208b739c5bd7dcd168d1a7","modified":1638778544000},{"_id":"themes/butterfly/source/css/_mode/readmode.styl","hash":"f59a9a0059d5261251bdd6de45aa97dd2d11e633","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/404.styl","hash":"b0488ceacde74af139d66c8db5cb36cc21737b9b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/archives.styl","hash":"6874adc2e276443f354bbe50d0072e9bec37243c","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/categories.styl","hash":"e554549f0a0ae85362f0b0e8687981741f486f6b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/common.styl","hash":"97fec1e814f88237862f4d800a35362b802f6625","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/flink.styl","hash":"2cc49d3f6a6beb9f7bff93e292f88aa5681da1d0","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/tags.styl","hash":"9a881c031f463c486bd25248c2814fd09f97892b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_page/homepage.styl","hash":"7c4152162a03aa8331a783df5695e4ebbb816a8c","modified":1638778544000},{"_id":"themes/butterfly/source/css/_search/algolia.styl","hash":"917e0e399e117217184ca63d3eb5c4843bcccf7b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_search/index.styl","hash":"f168f5c669978f633abe118cdcc4a12cfc883c01","modified":1638778544000},{"_id":"themes/butterfly/source/css/_search/local-search.styl","hash":"6befe4c51b86d0c1de130beeecad9e28d6442713","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/button.styl","hash":"1c3f9d7efc3b9dfcfa8926a1132d0c44ffc7d4b2","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/gallery.styl","hash":"53ecae272e16223a436c497abbf25dd5f0fc4aaa","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/hexo.styl","hash":"d0386ba6d8d63afc72b9673e8f3e89df6446ffc2","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/inlineImg.styl","hash":"df9d405c33a9a68946b530410f64096bcb72560c","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/label.styl","hash":"f741e85295ce15c70a6027ec15a542636dd5dcca","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/note.styl","hash":"86fee274a62f7f034547342930f445c47378eb55","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/hide.styl","hash":"21964fdd6d74ffbea519418bab65024aee5f3736","modified":1638778544000},{"_id":"themes/butterfly/source/css/_tags/tabs.styl","hash":"1756791581c0ec51cb03353a09dac4778d944349","modified":1638778544000},{"_id":"themes/butterfly/source/css/_third-party/normalize.min.css","hash":"2c18a1c9604af475b4749def8f1959df88d8b276","modified":1638778544000},{"_id":"themes/butterfly/source/js/search/local-search.js","hash":"b1429e9f80ef6b9a77434819ffb87d90bdad25e8","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/disqus.pug","hash":"d85c3737b5c9548553a78b757a7698df126a52cf","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/fb.pug","hash":"7848ec58c6ec03243abf80a3b22b4dc10f3edf53","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/valine.pug","hash":"bba9871f446c10ffcc8fa9023f5a2eb701a86bae","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/index.pug","hash":"e3bf847553515174f6085df982f0623e9783db7a","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/twikoo.pug","hash":"ef1b2b5b980d6aeaa5d06b97d1afc9644b155a16","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/card-post-count/waline.pug","hash":"400ce038548d6f9ddb486150c724c87b6923a88b","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/chatra.pug","hash":"481cd5053bafb1a19f623554a27d3aa077ea59c3","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/crisp.pug","hash":"76634112c64023177260d1317ae39cef2a68e35f","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/gitter.pug","hash":"d1d2474420bf4edc2e43ccdff6f92b8b082143df","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/index.pug","hash":"3f05f8311ae559d768ee3d0925e84ed767c314d3","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/daovoice.pug","hash":"cfe63e7d26a6665df6aa32ca90868ad48e05ec04","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqusjs.pug","hash":"2e52c64e89f16267596a8465841dd46f51820982","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/chat/tidio.pug","hash":"24a926756c2300b9c561aaab6bd3a71fdd16e16d","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/disqus.pug","hash":"a111407fdcafcf1099e26ffa69786f8822c5d9fb","modified":1638778544000},{"_id":"themes/butterfly/source/js/search/algolia.js","hash":"65b45e61586f7e66c3f338370bfd9daadd71a4b7","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/facebook_comments.pug","hash":"c46a932257212f82e4a9974fbbc5de8878c8b383","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/gitalk.pug","hash":"0b7571919e8ad51285deda56a1868fccf8c563d7","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/js.pug","hash":"bafb3d5710824caa59a56017afb058fd2b4eac65","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/index.pug","hash":"da9813f8dc0d388869c15413cf056012cfb69e1a","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/twikoo.pug","hash":"16378d8646ea3f4ac99c18f0296dd85b13f9d775","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/livere.pug","hash":"52ea8aa26b84d3ad38ae28cdf0f163e9ca8dced7","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/valine.pug","hash":"2b45fe09d5b591dca156b76dae99981f8d8e1c61","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/math/index.pug","hash":"b8ae5fd7d74e1edcef21f5004fc96147e064d219","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/math/mathjax.pug","hash":"a47d8f9f593091cc91192c0c49deaa2c0d2317fd","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/math/katex.pug","hash":"f9b00ead54573ba6e6eb33481588af144aab648d","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/waline.pug","hash":"36f3c603d2a2ecddaa6d2675a89d76ad94968f72","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/math/mermaid.pug","hash":"3f3a3cd8bea2103dedd754f767aca5cb84d5f586","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/disqus-comment.pug","hash":"b443d6b16baf3ea250041342cc0361a42a412b7f","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/github-issues.pug","hash":"34088a15655704d12e9b1807b47b3f6a860c9eec","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/twikoo-comment.pug","hash":"cb38ffe911023092a90a28f2ba8317a92b22cd0c","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/search/algolia.pug","hash":"d8f59e94eafc669c49349561dc5bbea3915aecb7","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/valine.pug","hash":"59b4c26a827ace5a54855881d199977103ff6f50","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/index.pug","hash":"f6506ccfd1ce994b9e53aa95588d0b6dbad11411","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/newest-comments/waline.pug","hash":"a2bc2601b7e0ae5caf1fc51a07390562d928620a","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/search/index.pug","hash":"da3b9437d061ee68dbc383057db5c73034c49605","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/search/local-search.pug","hash":"613280d61b8ab9612014ec016ae3d3698d36fd1a","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/share/add-this.pug","hash":"2980f1889226ca981aa23b8eb1853fde26dcf89a","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/comments/utterances.pug","hash":"b871ea208e36398b4d668db9a9a0b61c79415381","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/share/index.pug","hash":"4c4a9c15215ae8ac5eadb0e086b278f76db9ee92","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/share/addtoany.pug","hash":"309f51bc5302e72fc469d54c577fbcfe57fb07a8","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/highlight/index.styl","hash":"89cbcc8e087788ecec18b5fa58710afacdb7d080","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/highlight/diff.styl","hash":"8c0726fb8d9a497d2f900b0be2845efaa68e3d87","modified":1638778544000},{"_id":"themes/butterfly/layout/includes/third-party/share/share-js.pug","hash":"006acc91ce25fc7c7d778ca043e970f57dc46b83","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/diff.styl","hash":"5972c61f5125068cbe0af279a0c93a54847fdc3b","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/index.styl","hash":"e0e7065124ef0d99f8322a47bc47838982e04ad0","modified":1638778544000},{"_id":"themes/butterfly/source/css/_highlight/prismjs/line-number.styl","hash":"8970cc1916c982b64a1478792b2822d1d31e276d","modified":1638778544000},{"_id":"themes/butterfly/source/imgs/8.jpg","hash":"ca40a6e6edd5c4f553c402a46326d61f644390fb","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/2.jpg","hash":"fc879aaa2259d35dee3b5bfb1a958e5496432868","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/6.jpg","hash":"53ed5752511adddc42904b249d794629ea454966","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/7.jpg","hash":"90ca7d272d9fcc1a749e83596ff19e27734bb158","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/9.jpg","hash":"2a49a6e352e6e55640449bb846221036d2f41709","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/4.jpg","hash":"a6484636e812297df10f3de267568969019c7998","modified":1638842515000},{"_id":"themes/butterfly/source/imgs/5.jpg","hash":"4b9340a25769fa6041235ea75bc665770b29533a","modified":1638842515000},{"_id":"source/imgs/gongneng.jpg","hash":"5a80cc0cfdb96436341403a293509a4800e92d11","modified":1644919505273},{"_id":"themes/butterfly/source/imgs/1.jpg","hash":"fd5fcb8a8b4957ee6262bdc8b9f03ad62e9adb83","modified":1638842515000}],"Category":[],"Data":[{"_id":"link","data":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}],"Page":[{"title":"关于我","date":"2021-07-19T08:47:46.000Z","type":"about","_content":"\n\n\n一只立志要成为架构师的菜鸡程序员！\n\n\n![Image text](../imgs/taejune-kim-blue-1600.jpg)\n","source":"about/index.md","raw":"---\ntitle: 关于我\ndate: 2021-07-19 16:47:46\ntype: about\n---\n\n\n\n一只立志要成为架构师的菜鸡程序员！\n\n\n![Image text](../imgs/taejune-kim-blue-1600.jpg)\n","updated":"2022-02-15T10:05:05.268Z","path":"about/index.html","comments":1,"layout":"page","_id":"ckznz3ib90000k3sw1wx27lg8","content":"<p>一只立志要成为架构师的菜鸡程序员！</p>\n<p><img src=\"../imgs/taejune-kim-blue-1600.jpg\" alt=\"Image text\"></p>\n","site":{"data":{"link":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}},"cover":"/imgs/4.jpg","excerpt":"","more":"<p>一只立志要成为架构师的菜鸡程序员！</p>\n<p><img src=\"../imgs/taejune-kim-blue-1600.jpg\" alt=\"Image text\"></p>\n"},{"title":"分类","date":"2021-07-19T08:28:19.000Z","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2021-07-19 16:28:19\ntype: categories\n---\n","updated":"2022-02-15T10:05:05.268Z","path":"categories/index.html","comments":1,"layout":"page","_id":"ckznz3ibc0002k3sw2zlghzd7","content":"","site":{"data":{"link":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}},"cover":"/imgs/5.jpg","excerpt":"","more":""},{"title":"友情链接","date":"2021-07-19T08:16:44.000Z","type":"link","_content":"\n","source":"link/index.md","raw":"---\ntitle: 友情链接\ndate: 2021-07-19 16:16:44\ntype: \"link\"\n---\n\n","updated":"2022-02-15T10:05:05.275Z","path":"link/index.html","comments":1,"layout":"page","_id":"ckznz3ibd0004k3sw4g591vql","content":"","site":{"data":{"link":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}},"cover":"/imgs/1.jpg","excerpt":"","more":""},{"title":"tags","date":"2021-07-19T08:44:20.000Z","type":"tags","_content":"\n","source":"tags/index.md","raw":"---\ntitle: tags\ndate: 2021-07-19 16:44:20\ntype: tags\n---\n\n","updated":"2022-02-15T10:05:05.275Z","path":"tags/index.html","comments":1,"layout":"page","_id":"ckznz3ibd0005k3sw6x6sd9g1","content":"","site":{"data":{"link":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}},"cover":"/imgs/5.jpg","excerpt":"","more":""}],"Post":[{"title":"开源项目 mall 商城学习（一）","date":"2022-02-14T16:00:00.000Z","_content":"# 开源项目 mall 商城学习（一）\n\n**本阶段学习任务：**\n\n- **对项目功能和架构进行梳理**\n\n- **搭建环境让代码能够顺利运行**\n\n## 系统功能梳理\n\n**根据自己学习情况作出整理：**\n\n![](../imgs/gongneng.jpg)\n\n## 系统架构图\n\n![](../imgs/861644831979.jpg)\n\n\n\n## 项目环境搭建测试\n\n**说明：项目相关文档中，将数据库MySQL和其他环境同时创建部署，在实际操作过程中，部分组件会在启动时对MySQL数据库有依赖，确切的说是对数据库的schema有依赖，所以，先用Docker安装MySQL，并创建schema。**\n\n### 利用 Docker创建MySQL\n\n#### 方式一：Docker直接拉取相关镜像并运行\n\n##### 拉取镜像\n\n```shell\ndocker pull mysql:5.7.37\n```\n\n##### 运行镜像\n\n```shell\n# --name 后面的mysql是自定义容器名，my-secret-pw是MySQL的root账号密码\ndocker run --name mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:5.7.37\n```\n\n#### 方式二：Docker-compose搭建\n\n##### 创建 yaml 文件 *docker-compose-mysql.yaml*\n\n```properties\nversion: '3'\nservices:\n  mysql:\n    image: mysql:5.7\n    container_name: mysql\n    command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: root #设置root帐号密码\n    ports:\n      - 3306:3306\n    volumes:\n      - /mydata/mysql/data/db:/var/lib/mysql #数据文件挂载\n      - /mydata/mysql/data/conf:/etc/mysql/conf.d #配置文件挂载\n      - /mydata/mysql/log:/var/log/mysql #日志文件挂载\n```\n\n##### Docker-compose执行\n\n```shell\ndocker-compose -f docker-compose-mysql.yaml up -d\n```\n\n执行命令后，docker 会自动拉取相关的镜像，并配置启动。\n\n**注：挂载卷相关文件夹要提前创建**\n\n#### 进入MySQL容器操作，修改host便于远程界面工具访问\n\n```shell\ndocker exec -it mysql bash\nmysql -uroot -p\n# 输入密码，进入数据库\n# 切换到mysql库\n> use mysql\n> update user set host = '%' where user = 'root';\n> flush privileges;\n```\n\n**MySQL 可以远程通过外网访问了**\n\n [获取更多 docker MySQL 操作]([Docker Hub](https://hub.docker.com/_/mysql))\n\n#### 界面工具连接MySQL，导入sql脚本（略）\n\n### Docker-compose搭建环境\n\n**其他环境镜像较多，分别安装比较耗时，所以使用Docker-compose打包安装**\n\n#### 创建 yaml 配置文件 docker-compose-env.yaml\n\n```properties\nversion: '3'\nservices:\n  redis:\n    image: redis:5\n    container_name: redis\n    command: redis-server --appendonly yes\n    volumes:\n      - /mydata/redis/data:/data #数据文件挂载\n    ports:\n      - 6379:6379\n  nginx:\n    image: nginx:1.10\n    container_name: nginx\n    volumes:\n      - /mydata/nginx/conf:/etc/nginx #配置文件挂载\n      - /mydata/nginx/html:/usr/share/nginx/html #静态资源根目录挂载\n      - /mydata/nginx/log:/var/log/nginx #日志文件挂载\n    ports:\n      - 80:80\n  rabbitmq:\n    image: rabbitmq:3.7.15-management\n    container_name: rabbitmq\n    volumes:\n      - /mydata/rabbitmq/data:/var/lib/rabbitmq #数据文件挂载\n      - /mydata/rabbitmq/log:/var/log/rabbitmq #日志文件挂载\n    ports:\n      - 5672:5672\n      - 15672:15672\n  elasticsearch:\n    image: elasticsearch:7.6.2\n    container_name: elasticsearch\n    user: root\n    environment:\n      - \"cluster.name=elasticsearch\" #设置集群名称为elasticsearch\n      - \"discovery.type=single-node\" #以单一节点模式启动\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" #设置使用jvm内存大小\n    volumes:\n      - /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins #插件文件挂载\n      - /mydata/elasticsearch/data:/usr/share/elasticsearch/data #数据文件挂载\n    ports:\n      - 9200:9200\n      - 9300:9300\n  logstash:\n    image: logstash:7.6.2\n    container_name: logstash\n    environment:\n      - TZ=Asia/Shanghai\n    volumes:\n      - /mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf #挂载logstash的配置文件\n    depends_on:\n      - elasticsearch #kibana在elasticsearch启动之后再启动\n    links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n    ports:\n      - 4560:4560\n      - 4561:4561\n      - 4562:4562\n      - 4563:4563\n  kibana:\n    image: kibana:7.6.2\n    container_name: kibana\n    links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n    depends_on:\n      - elasticsearch #kibana在elasticsearch启动之后再启动\n    environment:\n      - \"elasticsearch.hosts=http://es:9200\" #设置访问elasticsearch的地址\n    ports:\n      - 5601:5601\n  mongo:\n    image: mongo:4.2.5\n    container_name: mongo\n    volumes:\n      - /mydata/mongo/db:/data/db #数据文件挂载\n    ports:\n      - 27017:27017\n  nacos-registry:\n    image: nacos/nacos-server:1.3.0\n    container_name: nacos-registry\n    environment:\n      - \"MODE=standalone\"\n    ports:\n      - 8848:8848\n```\n\n#### docker-compose执行\n\n```shell\ndocker-compose -f docker-compose-env.yaml up -d\n```\n\n\n\n## 四、项目代码运行测试\n\n        微服务项目，子项目众多，分别打包有些不便，借助 Maven 插件，将项目打包后，生成docker 镜像推送到 docker 服务中。\n\n### 配置Docker远程环境\n\n#### 搭建 Docker Registry\n\n```shell\ndocker run -d -p 5000:5000 --restart=always --name registry2 registry:2\n```\n\ndocker 会拉取 registry 镜像\n\n#### Docker 开启远程API\n\n修改 docker.service文件：\n\n```shell\nvim /usr/lib/systemd/system/docker.service\n```\n\n找到\n\n```shell\nExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock\n```\n\n修改为：\n\n```shell\nExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\n```\n\n#### 让Docker支持http上传镜像\n\n```shell\necho '{ \"insecure-registries\":[\"192.168.3.101:5000\"] }' > /etc/docker/daemon.json\n```\n\n#### 让配置生效\n\n```shell\nsystemctl daemon-reload\n```\n\n#### 重新启动Docker服务\n\n```shell\nsystemctl stop docker\nsystemctl start docker\n```\n\n#### 防火墙设置\n\n**若服务器开启了防火墙：**\n\n```shell\nfirewall-cmd --zone=public --add-port=2375/tcp --permanent\nfirewall-cmd --reload\n```\n\n### 使用Maven构建Docker镜像\n\n在各子项目应用的 pom.xml 文件中添加 docker-maven-plugin 的依赖：\n\n```xml\n<plugin>\n    <groupId>com.spotify</groupId>\n    <artifactId>docker-maven-plugin</artifactId>\n    <!-- 这里版本号可能会出现冲突，注释掉即可 -->\n    <version>1.1.0</version>\n    <executions>\n        <execution>\n            <id>build-image</id>\n            <phase>package</phase>\n            <goals>\n                <goal>build</goal>\n            </goals>\n        </execution>\n    </executions>\n    <configuration>\n        <imageName>mall/${project.artifactId}:${project.version}</imageName>\n        <dockerHost>http://docker-host:2375</dockerHost>\n        <baseImage>java:8</baseImage>\n        <entryPoint>[\"java\", \"-jar\",\"/${project.build.finalName}.jar\"]\n        </entryPoint>\n        <resources>\n            <resource>\n                <targetPath>/</targetPath>\n                <directory>${project.build.directory}</directory>\n                <include>${project.build.finalName}.jar</include>\n            </resource>\n        </resources>\n    </configuration>\n</plugin>\n```\n\n**配置说明：**\n\n- executions.execution.phase:此处配置了在maven打包应用时构建docker镜像；\n\n- imageName：用于指定镜像名称，mall-tiny是仓库名称，`${project.artifactId}`为镜像名称，`${project.version}`为仓库名称；\n\n- dockerHost：打包后上传到的docker服务器地址；\n\n- baseImage：该应用所依赖的基础镜像，此处为java；\n\n- entryPoint：docker容器启动时执行的命令；\n\n- resources.resource.targetPath：将打包后的资源文件复制到该目录；\n\n- resources.resource.directory：需要复制的文件所在目录，maven打包的应用jar包保存在target目录下面；\n\n- resources.resource.include：需要复制的文件，打包好的应用jar包。\n\n**执行 Maven 的package命令，打包成功后，docker 中会出现相应的镜像。**\n\n### 各子项目在docker中启动\n\n#### 创建 yaml 配置文件 docker-compose-app.yaml\n\n```properties\nversion: '3'\nservices:\n  mall-admin:\n    image: mall/mall-admin:1.0-SNAPSHOT\n    container_name: mall-admin\n    ports:\n      - 8080:8080\n    volumes:\n      - /mydata/app/mall-admin/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - mysql:db #可以用db这个域名访问mysql服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-search:\n    image: mall/mall-search:1.0-SNAPSHOT\n    container_name: mall-search\n    ports:\n      - 8081:8081\n    volumes:\n      - /mydata/app/mall-search/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n      - mysql:db #可以用db这个域名访问mysql服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-portal:\n    image: mall/mall-portal:1.0-SNAPSHOT\n    container_name: mall-portal\n    ports:\n      - 8085:8085\n    volumes:\n      - /mydata/app/mall-portal/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - redis:redis #可以用redis这个域名访问redis服务\n      - mongo:mongo #可以用mongo这个域名访问mongo服务\n      - mysql:db #可以用db这个域名访问mysql服务\n      - rabbitmq:rabbit #可以用rabbit这个域名访问rabbitmq服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-auth:\n    image: mall/mall-auth:1.0-SNAPSHOT\n    container_name: mall-auth\n    ports:\n      - 8401:8401\n    volumes:\n      - /mydata/app/mall-auth/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-gateway:\n    image: mall/mall-gateway:1.0-SNAPSHOT\n    container_name: mall-gateway\n    ports:\n      - 8201:8201\n    volumes:\n      - /mydata/app/mall-gateway/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - redis:redis #可以用redis这个域名访问redis服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-monitor:\n    image: mall/mall-monitor:1.0-SNAPSHOT\n    container_name: mall-monitor\n    ports:\n      - 8101:8101\n    volumes:\n      - /mydata/app/mall-monitor/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n```\n\n#### Docker-compose 启动项目\n\n```shell\ndocker-compose -f docker-compose-app.yaml up -d\n```\n\n\n","source":"_posts/开源项目 mall 商城学习（一）.md","raw":"---\ntitle: 开源项目 mall 商城学习（一）\ndate: 2022-2-15\ntags: mall 商城\n---\n# 开源项目 mall 商城学习（一）\n\n**本阶段学习任务：**\n\n- **对项目功能和架构进行梳理**\n\n- **搭建环境让代码能够顺利运行**\n\n## 系统功能梳理\n\n**根据自己学习情况作出整理：**\n\n![](../imgs/gongneng.jpg)\n\n## 系统架构图\n\n![](../imgs/861644831979.jpg)\n\n\n\n## 项目环境搭建测试\n\n**说明：项目相关文档中，将数据库MySQL和其他环境同时创建部署，在实际操作过程中，部分组件会在启动时对MySQL数据库有依赖，确切的说是对数据库的schema有依赖，所以，先用Docker安装MySQL，并创建schema。**\n\n### 利用 Docker创建MySQL\n\n#### 方式一：Docker直接拉取相关镜像并运行\n\n##### 拉取镜像\n\n```shell\ndocker pull mysql:5.7.37\n```\n\n##### 运行镜像\n\n```shell\n# --name 后面的mysql是自定义容器名，my-secret-pw是MySQL的root账号密码\ndocker run --name mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:5.7.37\n```\n\n#### 方式二：Docker-compose搭建\n\n##### 创建 yaml 文件 *docker-compose-mysql.yaml*\n\n```properties\nversion: '3'\nservices:\n  mysql:\n    image: mysql:5.7\n    container_name: mysql\n    command: mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: root #设置root帐号密码\n    ports:\n      - 3306:3306\n    volumes:\n      - /mydata/mysql/data/db:/var/lib/mysql #数据文件挂载\n      - /mydata/mysql/data/conf:/etc/mysql/conf.d #配置文件挂载\n      - /mydata/mysql/log:/var/log/mysql #日志文件挂载\n```\n\n##### Docker-compose执行\n\n```shell\ndocker-compose -f docker-compose-mysql.yaml up -d\n```\n\n执行命令后，docker 会自动拉取相关的镜像，并配置启动。\n\n**注：挂载卷相关文件夹要提前创建**\n\n#### 进入MySQL容器操作，修改host便于远程界面工具访问\n\n```shell\ndocker exec -it mysql bash\nmysql -uroot -p\n# 输入密码，进入数据库\n# 切换到mysql库\n> use mysql\n> update user set host = '%' where user = 'root';\n> flush privileges;\n```\n\n**MySQL 可以远程通过外网访问了**\n\n [获取更多 docker MySQL 操作]([Docker Hub](https://hub.docker.com/_/mysql))\n\n#### 界面工具连接MySQL，导入sql脚本（略）\n\n### Docker-compose搭建环境\n\n**其他环境镜像较多，分别安装比较耗时，所以使用Docker-compose打包安装**\n\n#### 创建 yaml 配置文件 docker-compose-env.yaml\n\n```properties\nversion: '3'\nservices:\n  redis:\n    image: redis:5\n    container_name: redis\n    command: redis-server --appendonly yes\n    volumes:\n      - /mydata/redis/data:/data #数据文件挂载\n    ports:\n      - 6379:6379\n  nginx:\n    image: nginx:1.10\n    container_name: nginx\n    volumes:\n      - /mydata/nginx/conf:/etc/nginx #配置文件挂载\n      - /mydata/nginx/html:/usr/share/nginx/html #静态资源根目录挂载\n      - /mydata/nginx/log:/var/log/nginx #日志文件挂载\n    ports:\n      - 80:80\n  rabbitmq:\n    image: rabbitmq:3.7.15-management\n    container_name: rabbitmq\n    volumes:\n      - /mydata/rabbitmq/data:/var/lib/rabbitmq #数据文件挂载\n      - /mydata/rabbitmq/log:/var/log/rabbitmq #日志文件挂载\n    ports:\n      - 5672:5672\n      - 15672:15672\n  elasticsearch:\n    image: elasticsearch:7.6.2\n    container_name: elasticsearch\n    user: root\n    environment:\n      - \"cluster.name=elasticsearch\" #设置集群名称为elasticsearch\n      - \"discovery.type=single-node\" #以单一节点模式启动\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" #设置使用jvm内存大小\n    volumes:\n      - /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins #插件文件挂载\n      - /mydata/elasticsearch/data:/usr/share/elasticsearch/data #数据文件挂载\n    ports:\n      - 9200:9200\n      - 9300:9300\n  logstash:\n    image: logstash:7.6.2\n    container_name: logstash\n    environment:\n      - TZ=Asia/Shanghai\n    volumes:\n      - /mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf #挂载logstash的配置文件\n    depends_on:\n      - elasticsearch #kibana在elasticsearch启动之后再启动\n    links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n    ports:\n      - 4560:4560\n      - 4561:4561\n      - 4562:4562\n      - 4563:4563\n  kibana:\n    image: kibana:7.6.2\n    container_name: kibana\n    links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n    depends_on:\n      - elasticsearch #kibana在elasticsearch启动之后再启动\n    environment:\n      - \"elasticsearch.hosts=http://es:9200\" #设置访问elasticsearch的地址\n    ports:\n      - 5601:5601\n  mongo:\n    image: mongo:4.2.5\n    container_name: mongo\n    volumes:\n      - /mydata/mongo/db:/data/db #数据文件挂载\n    ports:\n      - 27017:27017\n  nacos-registry:\n    image: nacos/nacos-server:1.3.0\n    container_name: nacos-registry\n    environment:\n      - \"MODE=standalone\"\n    ports:\n      - 8848:8848\n```\n\n#### docker-compose执行\n\n```shell\ndocker-compose -f docker-compose-env.yaml up -d\n```\n\n\n\n## 四、项目代码运行测试\n\n        微服务项目，子项目众多，分别打包有些不便，借助 Maven 插件，将项目打包后，生成docker 镜像推送到 docker 服务中。\n\n### 配置Docker远程环境\n\n#### 搭建 Docker Registry\n\n```shell\ndocker run -d -p 5000:5000 --restart=always --name registry2 registry:2\n```\n\ndocker 会拉取 registry 镜像\n\n#### Docker 开启远程API\n\n修改 docker.service文件：\n\n```shell\nvim /usr/lib/systemd/system/docker.service\n```\n\n找到\n\n```shell\nExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock\n```\n\n修改为：\n\n```shell\nExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock\n```\n\n#### 让Docker支持http上传镜像\n\n```shell\necho '{ \"insecure-registries\":[\"192.168.3.101:5000\"] }' > /etc/docker/daemon.json\n```\n\n#### 让配置生效\n\n```shell\nsystemctl daemon-reload\n```\n\n#### 重新启动Docker服务\n\n```shell\nsystemctl stop docker\nsystemctl start docker\n```\n\n#### 防火墙设置\n\n**若服务器开启了防火墙：**\n\n```shell\nfirewall-cmd --zone=public --add-port=2375/tcp --permanent\nfirewall-cmd --reload\n```\n\n### 使用Maven构建Docker镜像\n\n在各子项目应用的 pom.xml 文件中添加 docker-maven-plugin 的依赖：\n\n```xml\n<plugin>\n    <groupId>com.spotify</groupId>\n    <artifactId>docker-maven-plugin</artifactId>\n    <!-- 这里版本号可能会出现冲突，注释掉即可 -->\n    <version>1.1.0</version>\n    <executions>\n        <execution>\n            <id>build-image</id>\n            <phase>package</phase>\n            <goals>\n                <goal>build</goal>\n            </goals>\n        </execution>\n    </executions>\n    <configuration>\n        <imageName>mall/${project.artifactId}:${project.version}</imageName>\n        <dockerHost>http://docker-host:2375</dockerHost>\n        <baseImage>java:8</baseImage>\n        <entryPoint>[\"java\", \"-jar\",\"/${project.build.finalName}.jar\"]\n        </entryPoint>\n        <resources>\n            <resource>\n                <targetPath>/</targetPath>\n                <directory>${project.build.directory}</directory>\n                <include>${project.build.finalName}.jar</include>\n            </resource>\n        </resources>\n    </configuration>\n</plugin>\n```\n\n**配置说明：**\n\n- executions.execution.phase:此处配置了在maven打包应用时构建docker镜像；\n\n- imageName：用于指定镜像名称，mall-tiny是仓库名称，`${project.artifactId}`为镜像名称，`${project.version}`为仓库名称；\n\n- dockerHost：打包后上传到的docker服务器地址；\n\n- baseImage：该应用所依赖的基础镜像，此处为java；\n\n- entryPoint：docker容器启动时执行的命令；\n\n- resources.resource.targetPath：将打包后的资源文件复制到该目录；\n\n- resources.resource.directory：需要复制的文件所在目录，maven打包的应用jar包保存在target目录下面；\n\n- resources.resource.include：需要复制的文件，打包好的应用jar包。\n\n**执行 Maven 的package命令，打包成功后，docker 中会出现相应的镜像。**\n\n### 各子项目在docker中启动\n\n#### 创建 yaml 配置文件 docker-compose-app.yaml\n\n```properties\nversion: '3'\nservices:\n  mall-admin:\n    image: mall/mall-admin:1.0-SNAPSHOT\n    container_name: mall-admin\n    ports:\n      - 8080:8080\n    volumes:\n      - /mydata/app/mall-admin/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - mysql:db #可以用db这个域名访问mysql服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-search:\n    image: mall/mall-search:1.0-SNAPSHOT\n    container_name: mall-search\n    ports:\n      - 8081:8081\n    volumes:\n      - /mydata/app/mall-search/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - elasticsearch:es #可以用es这个域名访问elasticsearch服务\n      - mysql:db #可以用db这个域名访问mysql服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-portal:\n    image: mall/mall-portal:1.0-SNAPSHOT\n    container_name: mall-portal\n    ports:\n      - 8085:8085\n    volumes:\n      - /mydata/app/mall-portal/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - redis:redis #可以用redis这个域名访问redis服务\n      - mongo:mongo #可以用mongo这个域名访问mongo服务\n      - mysql:db #可以用db这个域名访问mysql服务\n      - rabbitmq:rabbit #可以用rabbit这个域名访问rabbitmq服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-auth:\n    image: mall/mall-auth:1.0-SNAPSHOT\n    container_name: mall-auth\n    ports:\n      - 8401:8401\n    volumes:\n      - /mydata/app/mall-auth/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-gateway:\n    image: mall/mall-gateway:1.0-SNAPSHOT\n    container_name: mall-gateway\n    ports:\n      - 8201:8201\n    volumes:\n      - /mydata/app/mall-gateway/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - redis:redis #可以用redis这个域名访问redis服务\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n  mall-monitor:\n    image: mall/mall-monitor:1.0-SNAPSHOT\n    container_name: mall-monitor\n    ports:\n      - 8101:8101\n    volumes:\n      - /mydata/app/mall-monitor/logs:/var/logs\n      - /etc/localtime:/etc/localtime\n    environment:\n      - 'TZ=\"Asia/Shanghai\"'\n    external_links:\n      - nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务\n```\n\n#### Docker-compose 启动项目\n\n```shell\ndocker-compose -f docker-compose-app.yaml up -d\n```\n\n\n","slug":"开源项目 mall 商城学习（一）","published":1,"updated":"2022-02-15T10:05:05.268Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckznz3iba0001k3sw6qyc39qn","content":"<h1 id=\"开源项目-mall-商城学习（一）\"><a href=\"#开源项目-mall-商城学习（一）\" class=\"headerlink\" title=\"开源项目 mall 商城学习（一）\"></a>开源项目 mall 商城学习（一）</h1><p><strong>本阶段学习任务：</strong></p>\n<ul>\n<li><p><strong>对项目功能和架构进行梳理</strong></p>\n</li>\n<li><p><strong>搭建环境让代码能够顺利运行</strong></p>\n</li>\n</ul>\n<h2 id=\"系统功能梳理\"><a href=\"#系统功能梳理\" class=\"headerlink\" title=\"系统功能梳理\"></a>系统功能梳理</h2><p><strong>根据自己学习情况作出整理：</strong></p>\n<p><img src=\"../imgs/gongneng.jpg\"></p>\n<h2 id=\"系统架构图\"><a href=\"#系统架构图\" class=\"headerlink\" title=\"系统架构图\"></a>系统架构图</h2><p><img src=\"../imgs/861644831979.jpg\"></p>\n<h2 id=\"项目环境搭建测试\"><a href=\"#项目环境搭建测试\" class=\"headerlink\" title=\"项目环境搭建测试\"></a>项目环境搭建测试</h2><p><strong>说明：项目相关文档中，将数据库MySQL和其他环境同时创建部署，在实际操作过程中，部分组件会在启动时对MySQL数据库有依赖，确切的说是对数据库的schema有依赖，所以，先用Docker安装MySQL，并创建schema。</strong></p>\n<h3 id=\"利用-Docker创建MySQL\"><a href=\"#利用-Docker创建MySQL\" class=\"headerlink\" title=\"利用 Docker创建MySQL\"></a>利用 Docker创建MySQL</h3><h4 id=\"方式一：Docker直接拉取相关镜像并运行\"><a href=\"#方式一：Docker直接拉取相关镜像并运行\" class=\"headerlink\" title=\"方式一：Docker直接拉取相关镜像并运行\"></a>方式一：Docker直接拉取相关镜像并运行</h4><h5 id=\"拉取镜像\"><a href=\"#拉取镜像\" class=\"headerlink\" title=\"拉取镜像\"></a>拉取镜像</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:5.7.37</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"运行镜像\"><a href=\"#运行镜像\" class=\"headerlink\" title=\"运行镜像\"></a>运行镜像</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> --name 后面的mysql是自定义容器名，my-secret-pw是MySQL的root账号密码</span></span><br><span class=\"line\">docker run --name mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:5.7.37</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"方式二：Docker-compose搭建\"><a href=\"#方式二：Docker-compose搭建\" class=\"headerlink\" title=\"方式二：Docker-compose搭建\"></a>方式二：Docker-compose搭建</h4><h5 id=\"创建-yaml-文件-docker-compose-mysql-yaml\"><a href=\"#创建-yaml-文件-docker-compose-mysql-yaml\" class=\"headerlink\" title=\"创建 yaml 文件 docker-compose-mysql.yaml\"></a>创建 yaml 文件 <em>docker-compose-mysql.yaml</em></h5><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"attr\">mysql</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mysql:5.7</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mysql</span></span><br><span class=\"line\">    <span class=\"attr\">command</span>: <span class=\"string\">mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</span></span><br><span class=\"line\">    <span class=\"attr\">restart</span>: <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>: <span class=\"string\">root #设置root帐号密码</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">3306:3306</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/data/db:/var/lib/mysql #数据文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/data/conf:/etc/mysql/conf.d #配置文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/log:/var/log/mysql #日志文件挂载</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"Docker-compose执行\"><a href=\"#Docker-compose执行\" class=\"headerlink\" title=\"Docker-compose执行\"></a>Docker-compose执行</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-mysql.yaml up -d</span><br></pre></td></tr></table></figure>\n\n<p>执行命令后，docker 会自动拉取相关的镜像，并配置启动。</p>\n<p><strong>注：挂载卷相关文件夹要提前创建</strong></p>\n<h4 id=\"进入MySQL容器操作，修改host便于远程界面工具访问\"><a href=\"#进入MySQL容器操作，修改host便于远程界面工具访问\" class=\"headerlink\" title=\"进入MySQL容器操作，修改host便于远程界面工具访问\"></a>进入MySQL容器操作，修改host便于远程界面工具访问</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it mysql bash</span><br><span class=\"line\">mysql -uroot -p</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 输入密码，进入数据库</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 切换到mysql库</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> use mysql</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> update user <span class=\"built_in\">set</span> host = <span class=\"string\">&#x27;%&#x27;</span> <span class=\"built_in\">where</span> user = <span class=\"string\">&#x27;root&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> flush privileges;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>MySQL 可以远程通过外网访问了</strong></p>\n<p> [获取更多 docker MySQL 操作](<a href=\"https://hub.docker.com/_/mysql\">Docker Hub</a>)</p>\n<h4 id=\"界面工具连接MySQL，导入sql脚本（略）\"><a href=\"#界面工具连接MySQL，导入sql脚本（略）\" class=\"headerlink\" title=\"界面工具连接MySQL，导入sql脚本（略）\"></a>界面工具连接MySQL，导入sql脚本（略）</h4><h3 id=\"Docker-compose搭建环境\"><a href=\"#Docker-compose搭建环境\" class=\"headerlink\" title=\"Docker-compose搭建环境\"></a>Docker-compose搭建环境</h3><p><strong>其他环境镜像较多，分别安装比较耗时，所以使用Docker-compose打包安装</strong></p>\n<h4 id=\"创建-yaml-配置文件-docker-compose-env-yaml\"><a href=\"#创建-yaml-配置文件-docker-compose-env-yaml\" class=\"headerlink\" title=\"创建 yaml 配置文件 docker-compose-env.yaml\"></a>创建 yaml 配置文件 docker-compose-env.yaml</h4><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"attr\">redis</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">redis:5</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">redis</span></span><br><span class=\"line\">    <span class=\"attr\">command</span>: <span class=\"string\">redis-server --appendonly yes</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/redis/data:/data #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">6379:6379</span></span><br><span class=\"line\">  <span class=\"attr\">nginx</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">nginx:1.10</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">nginx</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/conf:/etc/nginx #配置文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/html:/usr/share/nginx/html #静态资源根目录挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/log:/var/log/nginx #日志文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">80:80</span></span><br><span class=\"line\">  <span class=\"attr\">rabbitmq</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">rabbitmq:3.7.15-management</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">rabbitmq</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/rabbitmq/data:/var/lib/rabbitmq #数据文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/rabbitmq/log:/var/log/rabbitmq #日志文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">5672:5672</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">15672:15672</span></span><br><span class=\"line\">  <span class=\"attr\">elasticsearch</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">elasticsearch:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">elasticsearch</span></span><br><span class=\"line\">    <span class=\"attr\">user</span>: <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;cluster.name=elasticsearch&quot; #设置集群名称为elasticsearch</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;discovery.type=single-node&quot; #以单一节点模式启动</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; #设置使用jvm内存大小</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins #插件文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/elasticsearch/data:/usr/share/elasticsearch/data #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">9200:9200</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">9300:9300</span></span><br><span class=\"line\">  <span class=\"attr\">logstash</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">logstash:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">logstash</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">TZ=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf #挂载logstash的配置文件</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch #kibana在elasticsearch启动之后再启动</span></span><br><span class=\"line\">    <span class=\"attr\">links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4560:4560</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4561:4561</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4562:4562</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4563:4563</span></span><br><span class=\"line\">  <span class=\"attr\">kibana</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">kibana:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">kibana</span></span><br><span class=\"line\">    <span class=\"attr\">links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch #kibana在elasticsearch启动之后再启动</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;elasticsearch.hosts=http://es:9200&quot; #设置访问elasticsearch的地址</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">5601:5601</span></span><br><span class=\"line\">  <span class=\"attr\">mongo</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mongo:4.2.5</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mongo</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mongo/db:/data/db #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">27017:27017</span></span><br><span class=\"line\">  <span class=\"meta\">nacos-registry</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">nacos/nacos-server:1.3.0</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">nacos-registry</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;MODE=standalone&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8848:8848</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"docker-compose执行\"><a href=\"#docker-compose执行\" class=\"headerlink\" title=\"docker-compose执行\"></a>docker-compose执行</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-env.yaml up -d</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"四、项目代码运行测试\"><a href=\"#四、项目代码运行测试\" class=\"headerlink\" title=\"四、项目代码运行测试\"></a>四、项目代码运行测试</h2><p>        微服务项目，子项目众多，分别打包有些不便，借助 Maven 插件，将项目打包后，生成docker 镜像推送到 docker 服务中。</p>\n<h3 id=\"配置Docker远程环境\"><a href=\"#配置Docker远程环境\" class=\"headerlink\" title=\"配置Docker远程环境\"></a>配置Docker远程环境</h3><h4 id=\"搭建-Docker-Registry\"><a href=\"#搭建-Docker-Registry\" class=\"headerlink\" title=\"搭建 Docker Registry\"></a>搭建 Docker Registry</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 5000:5000 --restart=always --name registry2 registry:2</span><br></pre></td></tr></table></figure>\n\n<p>docker 会拉取 registry 镜像</p>\n<h4 id=\"Docker-开启远程API\"><a href=\"#Docker-开启远程API\" class=\"headerlink\" title=\"Docker 开启远程API\"></a>Docker 开启远程API</h4><p>修改 docker.service文件：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /usr/lib/systemd/system/docker.service</span><br></pre></td></tr></table></figure>\n\n<p>找到</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure>\n\n<p>修改为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"让Docker支持http上传镜像\"><a href=\"#让Docker支持http上传镜像\" class=\"headerlink\" title=\"让Docker支持http上传镜像\"></a>让Docker支持http上传镜像</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &#x27;&#123; &quot;insecure-registries&quot;:[&quot;192.168.3.101:5000&quot;] &#125;&#x27; &gt; /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"让配置生效\"><a href=\"#让配置生效\" class=\"headerlink\" title=\"让配置生效\"></a>让配置生效</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"重新启动Docker服务\"><a href=\"#重新启动Docker服务\" class=\"headerlink\" title=\"重新启动Docker服务\"></a>重新启动Docker服务</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop docker</span><br><span class=\"line\">systemctl start docker</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"防火墙设置\"><a href=\"#防火墙设置\" class=\"headerlink\" title=\"防火墙设置\"></a>防火墙设置</h4><p><strong>若服务器开启了防火墙：</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=2375/tcp --permanent</span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用Maven构建Docker镜像\"><a href=\"#使用Maven构建Docker镜像\" class=\"headerlink\" title=\"使用Maven构建Docker镜像\"></a>使用Maven构建Docker镜像</h3><p>在各子项目应用的 pom.xml 文件中添加 docker-maven-plugin 的依赖：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 这里版本号可能会出现冲突，注释掉即可 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>mall/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://docker-host:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">baseImage</span>&gt;</span>java:8<span class=\"tag\">&lt;/<span class=\"name\">baseImage</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">entryPoint</span>&gt;</span>[&quot;java&quot;, &quot;-jar&quot;,&quot;/$&#123;project.build.finalName&#125;.jar&quot;]</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">entryPoint</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>配置说明：</strong></p>\n<ul>\n<li><p>executions.execution.phase:此处配置了在maven打包应用时构建docker镜像；</p>\n</li>\n<li><p>imageName：用于指定镜像名称，mall-tiny是仓库名称，<code>$&#123;project.artifactId&#125;</code>为镜像名称，<code>$&#123;project.version&#125;</code>为仓库名称；</p>\n</li>\n<li><p>dockerHost：打包后上传到的docker服务器地址；</p>\n</li>\n<li><p>baseImage：该应用所依赖的基础镜像，此处为java；</p>\n</li>\n<li><p>entryPoint：docker容器启动时执行的命令；</p>\n</li>\n<li><p>resources.resource.targetPath：将打包后的资源文件复制到该目录；</p>\n</li>\n<li><p>resources.resource.directory：需要复制的文件所在目录，maven打包的应用jar包保存在target目录下面；</p>\n</li>\n<li><p>resources.resource.include：需要复制的文件，打包好的应用jar包。</p>\n</li>\n</ul>\n<p><strong>执行 Maven 的package命令，打包成功后，docker 中会出现相应的镜像。</strong></p>\n<h3 id=\"各子项目在docker中启动\"><a href=\"#各子项目在docker中启动\" class=\"headerlink\" title=\"各子项目在docker中启动\"></a>各子项目在docker中启动</h3><h4 id=\"创建-yaml-配置文件-docker-compose-app-yaml\"><a href=\"#创建-yaml-配置文件-docker-compose-app-yaml\" class=\"headerlink\" title=\"创建 yaml 配置文件 docker-compose-app.yaml\"></a>创建 yaml 配置文件 docker-compose-app.yaml</h4><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"meta\">mall-admin</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-admin:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-admin</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8080:8080</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-admin/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-search</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-search:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-search</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8081:8081</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-search/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-portal</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-portal:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-portal</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8085:8085</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-portal/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">redis:redis #可以用redis这个域名访问redis服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mongo:mongo #可以用mongo这个域名访问mongo服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">rabbitmq:rabbit #可以用rabbit这个域名访问rabbitmq服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-auth</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-auth:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-auth</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8401:8401</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-auth/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-gateway</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-gateway:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-gateway</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8201:8201</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-gateway/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">redis:redis #可以用redis这个域名访问redis服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-monitor</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-monitor:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-monitor</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8101:8101</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-monitor/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Docker-compose-启动项目\"><a href=\"#Docker-compose-启动项目\" class=\"headerlink\" title=\"Docker-compose 启动项目\"></a>Docker-compose 启动项目</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-app.yaml up -d</span><br></pre></td></tr></table></figure>\n\n\n","site":{"data":{"link":[{"class_name":"友情链接","class_desc":"靡不有初，鲜克有终","link_list":[{"name":null,"link":null,"avatar":"/imgs/motuo2.jpeg","descr":null}]}]}},"cover":"/imgs/5.jpg","excerpt":"","more":"<h1 id=\"开源项目-mall-商城学习（一）\"><a href=\"#开源项目-mall-商城学习（一）\" class=\"headerlink\" title=\"开源项目 mall 商城学习（一）\"></a>开源项目 mall 商城学习（一）</h1><p><strong>本阶段学习任务：</strong></p>\n<ul>\n<li><p><strong>对项目功能和架构进行梳理</strong></p>\n</li>\n<li><p><strong>搭建环境让代码能够顺利运行</strong></p>\n</li>\n</ul>\n<h2 id=\"系统功能梳理\"><a href=\"#系统功能梳理\" class=\"headerlink\" title=\"系统功能梳理\"></a>系统功能梳理</h2><p><strong>根据自己学习情况作出整理：</strong></p>\n<p><img src=\"../imgs/gongneng.jpg\"></p>\n<h2 id=\"系统架构图\"><a href=\"#系统架构图\" class=\"headerlink\" title=\"系统架构图\"></a>系统架构图</h2><p><img src=\"../imgs/861644831979.jpg\"></p>\n<h2 id=\"项目环境搭建测试\"><a href=\"#项目环境搭建测试\" class=\"headerlink\" title=\"项目环境搭建测试\"></a>项目环境搭建测试</h2><p><strong>说明：项目相关文档中，将数据库MySQL和其他环境同时创建部署，在实际操作过程中，部分组件会在启动时对MySQL数据库有依赖，确切的说是对数据库的schema有依赖，所以，先用Docker安装MySQL，并创建schema。</strong></p>\n<h3 id=\"利用-Docker创建MySQL\"><a href=\"#利用-Docker创建MySQL\" class=\"headerlink\" title=\"利用 Docker创建MySQL\"></a>利用 Docker创建MySQL</h3><h4 id=\"方式一：Docker直接拉取相关镜像并运行\"><a href=\"#方式一：Docker直接拉取相关镜像并运行\" class=\"headerlink\" title=\"方式一：Docker直接拉取相关镜像并运行\"></a>方式一：Docker直接拉取相关镜像并运行</h4><h5 id=\"拉取镜像\"><a href=\"#拉取镜像\" class=\"headerlink\" title=\"拉取镜像\"></a>拉取镜像</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull mysql:5.7.37</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"运行镜像\"><a href=\"#运行镜像\" class=\"headerlink\" title=\"运行镜像\"></a>运行镜像</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> --name 后面的mysql是自定义容器名，my-secret-pw是MySQL的root账号密码</span></span><br><span class=\"line\">docker run --name mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:5.7.37</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"方式二：Docker-compose搭建\"><a href=\"#方式二：Docker-compose搭建\" class=\"headerlink\" title=\"方式二：Docker-compose搭建\"></a>方式二：Docker-compose搭建</h4><h5 id=\"创建-yaml-文件-docker-compose-mysql-yaml\"><a href=\"#创建-yaml-文件-docker-compose-mysql-yaml\" class=\"headerlink\" title=\"创建 yaml 文件 docker-compose-mysql.yaml\"></a>创建 yaml 文件 <em>docker-compose-mysql.yaml</em></h5><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"attr\">mysql</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mysql:5.7</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mysql</span></span><br><span class=\"line\">    <span class=\"attr\">command</span>: <span class=\"string\">mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</span></span><br><span class=\"line\">    <span class=\"attr\">restart</span>: <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD</span>: <span class=\"string\">root #设置root帐号密码</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">3306:3306</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/data/db:/var/lib/mysql #数据文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/data/conf:/etc/mysql/conf.d #配置文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mysql/log:/var/log/mysql #日志文件挂载</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"Docker-compose执行\"><a href=\"#Docker-compose执行\" class=\"headerlink\" title=\"Docker-compose执行\"></a>Docker-compose执行</h5><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-mysql.yaml up -d</span><br></pre></td></tr></table></figure>\n\n<p>执行命令后，docker 会自动拉取相关的镜像，并配置启动。</p>\n<p><strong>注：挂载卷相关文件夹要提前创建</strong></p>\n<h4 id=\"进入MySQL容器操作，修改host便于远程界面工具访问\"><a href=\"#进入MySQL容器操作，修改host便于远程界面工具访问\" class=\"headerlink\" title=\"进入MySQL容器操作，修改host便于远程界面工具访问\"></a>进入MySQL容器操作，修改host便于远程界面工具访问</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker exec -it mysql bash</span><br><span class=\"line\">mysql -uroot -p</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 输入密码，进入数据库</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 切换到mysql库</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> use mysql</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> update user <span class=\"built_in\">set</span> host = <span class=\"string\">&#x27;%&#x27;</span> <span class=\"built_in\">where</span> user = <span class=\"string\">&#x27;root&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> flush privileges;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>MySQL 可以远程通过外网访问了</strong></p>\n<p> [获取更多 docker MySQL 操作](<a href=\"https://hub.docker.com/_/mysql\">Docker Hub</a>)</p>\n<h4 id=\"界面工具连接MySQL，导入sql脚本（略）\"><a href=\"#界面工具连接MySQL，导入sql脚本（略）\" class=\"headerlink\" title=\"界面工具连接MySQL，导入sql脚本（略）\"></a>界面工具连接MySQL，导入sql脚本（略）</h4><h3 id=\"Docker-compose搭建环境\"><a href=\"#Docker-compose搭建环境\" class=\"headerlink\" title=\"Docker-compose搭建环境\"></a>Docker-compose搭建环境</h3><p><strong>其他环境镜像较多，分别安装比较耗时，所以使用Docker-compose打包安装</strong></p>\n<h4 id=\"创建-yaml-配置文件-docker-compose-env-yaml\"><a href=\"#创建-yaml-配置文件-docker-compose-env-yaml\" class=\"headerlink\" title=\"创建 yaml 配置文件 docker-compose-env.yaml\"></a>创建 yaml 配置文件 docker-compose-env.yaml</h4><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"attr\">redis</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">redis:5</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">redis</span></span><br><span class=\"line\">    <span class=\"attr\">command</span>: <span class=\"string\">redis-server --appendonly yes</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/redis/data:/data #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">6379:6379</span></span><br><span class=\"line\">  <span class=\"attr\">nginx</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">nginx:1.10</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">nginx</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/conf:/etc/nginx #配置文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/html:/usr/share/nginx/html #静态资源根目录挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/nginx/log:/var/log/nginx #日志文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">80:80</span></span><br><span class=\"line\">  <span class=\"attr\">rabbitmq</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">rabbitmq:3.7.15-management</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">rabbitmq</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/rabbitmq/data:/var/lib/rabbitmq #数据文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/rabbitmq/log:/var/log/rabbitmq #日志文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">5672:5672</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">15672:15672</span></span><br><span class=\"line\">  <span class=\"attr\">elasticsearch</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">elasticsearch:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">elasticsearch</span></span><br><span class=\"line\">    <span class=\"attr\">user</span>: <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;cluster.name=elasticsearch&quot; #设置集群名称为elasticsearch</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;discovery.type=single-node&quot; #以单一节点模式启动</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;ES_JAVA_OPTS=-Xms512m -Xmx512m&quot; #设置使用jvm内存大小</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins #插件文件挂载</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/elasticsearch/data:/usr/share/elasticsearch/data #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">9200:9200</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">9300:9300</span></span><br><span class=\"line\">  <span class=\"attr\">logstash</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">logstash:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">logstash</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">TZ=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf #挂载logstash的配置文件</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch #kibana在elasticsearch启动之后再启动</span></span><br><span class=\"line\">    <span class=\"attr\">links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4560:4560</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4561:4561</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4562:4562</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">4563:4563</span></span><br><span class=\"line\">  <span class=\"attr\">kibana</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">kibana:7.6.2</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">kibana</span></span><br><span class=\"line\">    <span class=\"attr\">links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch #kibana在elasticsearch启动之后再启动</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;elasticsearch.hosts=http://es:9200&quot; #设置访问elasticsearch的地址</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">5601:5601</span></span><br><span class=\"line\">  <span class=\"attr\">mongo</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mongo:4.2.5</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mongo</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/mongo/db:/data/db #数据文件挂载</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">27017:27017</span></span><br><span class=\"line\">  <span class=\"meta\">nacos-registry</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">nacos/nacos-server:1.3.0</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">nacos-registry</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&quot;MODE=standalone&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8848:8848</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"docker-compose执行\"><a href=\"#docker-compose执行\" class=\"headerlink\" title=\"docker-compose执行\"></a>docker-compose执行</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-env.yaml up -d</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"四、项目代码运行测试\"><a href=\"#四、项目代码运行测试\" class=\"headerlink\" title=\"四、项目代码运行测试\"></a>四、项目代码运行测试</h2><p>        微服务项目，子项目众多，分别打包有些不便，借助 Maven 插件，将项目打包后，生成docker 镜像推送到 docker 服务中。</p>\n<h3 id=\"配置Docker远程环境\"><a href=\"#配置Docker远程环境\" class=\"headerlink\" title=\"配置Docker远程环境\"></a>配置Docker远程环境</h3><h4 id=\"搭建-Docker-Registry\"><a href=\"#搭建-Docker-Registry\" class=\"headerlink\" title=\"搭建 Docker Registry\"></a>搭建 Docker Registry</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -d -p 5000:5000 --restart=always --name registry2 registry:2</span><br></pre></td></tr></table></figure>\n\n<p>docker 会拉取 registry 镜像</p>\n<h4 id=\"Docker-开启远程API\"><a href=\"#Docker-开启远程API\" class=\"headerlink\" title=\"Docker 开启远程API\"></a>Docker 开启远程API</h4><p>修改 docker.service文件：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /usr/lib/systemd/system/docker.service</span><br></pre></td></tr></table></figure>\n\n<p>找到</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure>\n\n<p>修改为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ExecStart=/usr/bin/dockerd -H tcp://0.0.0.0:2375 -H unix://var/run/docker.sock</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"让Docker支持http上传镜像\"><a href=\"#让Docker支持http上传镜像\" class=\"headerlink\" title=\"让Docker支持http上传镜像\"></a>让Docker支持http上传镜像</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo &#x27;&#123; &quot;insecure-registries&quot;:[&quot;192.168.3.101:5000&quot;] &#125;&#x27; &gt; /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"让配置生效\"><a href=\"#让配置生效\" class=\"headerlink\" title=\"让配置生效\"></a>让配置生效</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl daemon-reload</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"重新启动Docker服务\"><a href=\"#重新启动Docker服务\" class=\"headerlink\" title=\"重新启动Docker服务\"></a>重新启动Docker服务</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop docker</span><br><span class=\"line\">systemctl start docker</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"防火墙设置\"><a href=\"#防火墙设置\" class=\"headerlink\" title=\"防火墙设置\"></a>防火墙设置</h4><p><strong>若服务器开启了防火墙：</strong></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">firewall-cmd --zone=public --add-port=2375/tcp --permanent</span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用Maven构建Docker镜像\"><a href=\"#使用Maven构建Docker镜像\" class=\"headerlink\" title=\"使用Maven构建Docker镜像\"></a>使用Maven构建Docker镜像</h3><p>在各子项目应用的 pom.xml 文件中添加 docker-maven-plugin 的依赖：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.spotify<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>docker-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 这里版本号可能会出现冲突，注释掉即可 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>build-image<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">phase</span>&gt;</span>package<span class=\"tag\">&lt;/<span class=\"name\">phase</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">goal</span>&gt;</span>build<span class=\"tag\">&lt;/<span class=\"name\">goal</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">goals</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">execution</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">executions</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">imageName</span>&gt;</span>mall/$&#123;project.artifactId&#125;:$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">imageName</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dockerHost</span>&gt;</span>http://docker-host:2375<span class=\"tag\">&lt;/<span class=\"name\">dockerHost</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">baseImage</span>&gt;</span>java:8<span class=\"tag\">&lt;/<span class=\"name\">baseImage</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">entryPoint</span>&gt;</span>[&quot;java&quot;, &quot;-jar&quot;,&quot;/$&#123;project.build.finalName&#125;.jar&quot;]</span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">entryPoint</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">targetPath</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">targetPath</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>$&#123;project.build.directory&#125;<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">include</span>&gt;</span>$&#123;project.build.finalName&#125;.jar<span class=\"tag\">&lt;/<span class=\"name\">include</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>配置说明：</strong></p>\n<ul>\n<li><p>executions.execution.phase:此处配置了在maven打包应用时构建docker镜像；</p>\n</li>\n<li><p>imageName：用于指定镜像名称，mall-tiny是仓库名称，<code>$&#123;project.artifactId&#125;</code>为镜像名称，<code>$&#123;project.version&#125;</code>为仓库名称；</p>\n</li>\n<li><p>dockerHost：打包后上传到的docker服务器地址；</p>\n</li>\n<li><p>baseImage：该应用所依赖的基础镜像，此处为java；</p>\n</li>\n<li><p>entryPoint：docker容器启动时执行的命令；</p>\n</li>\n<li><p>resources.resource.targetPath：将打包后的资源文件复制到该目录；</p>\n</li>\n<li><p>resources.resource.directory：需要复制的文件所在目录，maven打包的应用jar包保存在target目录下面；</p>\n</li>\n<li><p>resources.resource.include：需要复制的文件，打包好的应用jar包。</p>\n</li>\n</ul>\n<p><strong>执行 Maven 的package命令，打包成功后，docker 中会出现相应的镜像。</strong></p>\n<h3 id=\"各子项目在docker中启动\"><a href=\"#各子项目在docker中启动\" class=\"headerlink\" title=\"各子项目在docker中启动\"></a>各子项目在docker中启动</h3><h4 id=\"创建-yaml-配置文件-docker-compose-app-yaml\"><a href=\"#创建-yaml-配置文件-docker-compose-app-yaml\" class=\"headerlink\" title=\"创建 yaml 配置文件 docker-compose-app.yaml\"></a>创建 yaml 配置文件 docker-compose-app.yaml</h4><figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version</span>: <span class=\"string\">&#x27;3&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">services</span>:<span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"meta\">mall-admin</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-admin:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-admin</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8080:8080</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-admin/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-search</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-search:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-search</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8081:8081</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-search/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">elasticsearch:es #可以用es这个域名访问elasticsearch服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-portal</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-portal:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-portal</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8085:8085</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-portal/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">redis:redis #可以用redis这个域名访问redis服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mongo:mongo #可以用mongo这个域名访问mongo服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">mysql:db #可以用db这个域名访问mysql服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">rabbitmq:rabbit #可以用rabbit这个域名访问rabbitmq服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-auth</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-auth:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-auth</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8401:8401</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-auth/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-gateway</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-gateway:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-gateway</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8201:8201</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-gateway/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">redis:redis #可以用redis这个域名访问redis服务</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br><span class=\"line\">  <span class=\"meta\">mall-monitor</span>:<span class=\"string\"></span></span><br><span class=\"line\">    <span class=\"attr\">image</span>: <span class=\"string\">mall/mall-monitor:1.0-SNAPSHOT</span></span><br><span class=\"line\">    <span class=\"attr\">container_name</span>: <span class=\"string\">mall-monitor</span></span><br><span class=\"line\">    <span class=\"attr\">ports</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">8101:8101</span></span><br><span class=\"line\">    <span class=\"attr\">volumes</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/mydata/app/mall-monitor/logs:/var/logs</span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">/etc/localtime:/etc/localtime</span></span><br><span class=\"line\">    <span class=\"attr\">environment</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">&#x27;TZ=&quot;Asia/Shanghai&quot;&#x27;</span></span><br><span class=\"line\">    <span class=\"attr\">external_links</span>:<span class=\"string\"></span></span><br><span class=\"line\">      <span class=\"meta\">-</span> <span class=\"string\">nacos-registry:nacos-registry #可以用nacos-registry这个域名访问nacos服务</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Docker-compose-启动项目\"><a href=\"#Docker-compose-启动项目\" class=\"headerlink\" title=\"Docker-compose 启动项目\"></a>Docker-compose 启动项目</h4><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose-app.yaml up -d</span><br></pre></td></tr></table></figure>\n\n\n"}],"PostAsset":[],"PostCategory":[],"PostTag":[{"post_id":"ckznz3iba0001k3sw6qyc39qn","tag_id":"ckznz3ibc0003k3sw1dr0bjzo","_id":"ckznz3ibd0006k3sw9ghx8psp"}],"Tag":[{"name":"mall 商城","_id":"ckznz3ibc0003k3sw1dr0bjzo"}]}}